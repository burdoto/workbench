<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:insert="~{/layout/head}"></head>
<script th:src="@{/static/common.js}" type="text/javascript"></script>
<script th:src="@{/static/timetable.js}" type="text/javascript"></script>
<body onload="init()">
<div class="ui-menubar" th:insert="~{/layout/menubar}"></div>
<input id="table" th:value="${table}" type="hidden">
<input id="info" th:value="${info}" type="hidden">
<div class="ui-panel-1">
    <h2>Eintrag von <span th:text="${entry.dayText}"></span></h2>
    <div class="ui-panel-2">
        <h6><a class="ui-button view-content" onclick="editMode()">Bearbeiten...</a></h6>
        <input id="input-customerName" th:value="${entry.customer.name}" type="hidden">
        <table>
            <tr>
                <td>Kunde</td>
                <td th:text="${entry.customer.name}"></td>
            </tr>
            <tr>
                <td>Abteilung</td>
                <td th:text="${entry.department.name}"></td>
            </tr>
            <tr>
                <td>Beginn</td>
                <td th:text="${entry.startTimeText}"></td>
            </tr>
            <tr>
                <td><label for="input-endTime">Ende</label></td>
                <td class="edit-property" property="endTime">
                    <span class="view-content" th:text="${entry.endTimeText}"></span>
                    <input class="view-edit" id="input-endTime" th:value="${entry.endTimeString}" type="datetime-local">
                </td>
            </tr>
            <tr>
                <td><label for="input-notes">Bemerkungen</label></td>
                <td class="edit-property" property="notes">
                    <span class="view-content" th:text="${entry.notes.isBlank() ? '(keine)' : entry.notes}"></span>
                    <textarea class="view-edit" cols="80" id="input-notes" rows="5"
                              th:text="${entry.notes.isBlank() ? '(keine)' : entry.notes}"></textarea>
                </td>
            </tr>
        </table>
        <h6><a class="ui-button view-edit" onclick="applyEdits()">Ãœbernehmen</a></h6>
    </div>
    <div class="ui-panel-2">
        <h3>Aufgaben</h3>
        <h6><a class="ui-button"
               th:href="@{~/timetable/{customer}/{department}/{start}/assignment/create(
              customer=${entry.info().customerName()},
              department=${entry.info().departmentName()},
              start=${entry.info().startTime()}
)}">Neu...</a></h6>
        <table>
            <thead>
            <tr>
                <th>Benutzer</th>
                <th>Beginn</th>
                <th>Ende</th>
                <th>Bemerkungen</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="assignment: ${entry.assignments}">
                <td th:text="${assignment.user.displayName}"></td>
                <td th:text="${assignment.startTimeText}"></td>
                <td th:text="${assignment.endTimeText}"></td>
                <td th:text="${assignment.notes}"></td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="ui-panel-2">
        <h3>Unterbrechungen</h3>
        <table>
            <thead>
            <tr>
                <th>Beginn</th>
                <th>Dauer</th>
                <th>Bemerkungen</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="interruption: ${entry.interruptions}">
                <td th:text="${interruption.startTimeText}"></td>
                <td th:text="${interruption.durationText}"></td>
                <td th:text="${interruption.notes}"></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>
<div class="ui-footer" th:insert="~{/layout/footer}"></div>
</body>
</html>
